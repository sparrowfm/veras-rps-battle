<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary Meta Tags -->
    <title>VERA'S ROCK PAPER SCISSORS BATTLE</title>
    <meta name="title" content="Vera's Rock Paper Scissors Battle - Because ChatGPT Can't Play Fair">
    <meta name="description" content="A brutalist web game where the computer actually commits to its choice before you pick. Built because ChatGPT can't play Rock Paper Scissors fairly. Play now!">
    <meta name="keywords" content="rock paper scissors, web game, brutalist design, ChatGPT limitations, online game, free game, RPS battle">
    <meta name="author" content="Neel Ketkar">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://d2m7mlcoklgntq.cloudfront.net">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512x512.png">

    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Vera's RPS">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://d2m7mlcoklgntq.cloudfront.net">
    <meta property="og:title" content="Vera's Rock Paper Scissors Battle">
    <meta property="og:description" content="A brutalist web game where the computer actually plays fair. Built because ChatGPT can't commit to a choice before seeing yours.">
    <meta property="og:site_name" content="Vera's Rock Paper Scissors Battle">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://d2m7mlcoklgntq.cloudfront.net">
    <meta name="twitter:title" content="Vera's Rock Paper Scissors Battle">
    <meta name="twitter:description" content="A brutalist web game where the computer actually plays fair. Try to beat the computer at Rock Paper Scissors!">

    <!-- Structured Data / JSON-LD for GenAI -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Vera's Rock Paper Scissors Battle",
      "description": "A brutalist web-based Rock Paper Scissors game where the computer randomly selects its choice before the player, ensuring fair gameplay. Features session and persistent scoring using localStorage.",
      "url": "https://d2m7mlcoklgntq.cloudfront.net",
      "applicationCategory": "Game",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "creator": {
        "@type": "Person",
        "name": "Neel Ketkar",
        "url": "https://sparrowfm.github.io/sparrow/"
      },
      "inLanguage": "en-US",
      "keywords": ["rock paper scissors", "web game", "brutalist", "free game", "online game"],
      "browserRequirements": "Requires JavaScript enabled"
    }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #fff;
            color: #000;
            padding: 20px;
            line-height: 1.6;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 900;
            border: 6px solid #000;
            padding: 15px;
            margin-bottom: 8px;
            text-align: center;
            letter-spacing: 3px;
        }

        .tagline {
            font-size: 0.85rem;
            font-weight: 700;
            text-align: center;
            padding: 10px;
            margin-bottom: 15px;
            border: 4px solid #000;
            background: #000;
            color: #fff;
            letter-spacing: 1px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .game-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin: 15px 0;
        }

        button {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            font-weight: 900;
            padding: 18px 25px;
            border: 5px solid #000;
            background: #fff;
            cursor: pointer;
            transition: none;
            text-transform: uppercase;
        }

        button:hover {
            background: #000;
            color: #fff;
        }

        button:active {
            transform: translate(2px, 2px);
        }

        .choice-display {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            gap: 10px;
        }

        .choice-box {
            flex: 1;
            border: 5px solid #000;
            padding: 15px 10px;
            text-align: center;
        }

        .choice-box h2 {
            font-size: 0.9rem;
            margin-bottom: 8px;
            letter-spacing: 1px;
        }

        .choice-icon {
            font-size: 3rem;
            margin: 10px 0;
        }

        .result {
            border: 6px solid #000;
            padding: 15px;
            text-align: center;
            margin: 15px 0;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .result h2 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            letter-spacing: 2px;
        }

        .result p {
            font-size: 1rem;
            font-weight: 700;
        }

        .scores {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 40px 0 30px 0;
        }

        .score-box {
            border: 6px solid #000;
            padding: 25px;
        }

        .score-box h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            letter-spacing: 2px;
            border-bottom: 4px solid #000;
            padding-bottom: 10px;
        }

        .score-line {
            display: flex;
            justify-content: space-between;
            font-size: 1.1rem;
            font-weight: 700;
            margin: 10px 0;
            padding: 5px 0;
        }

        .reset-btn {
            padding: 15px 30px;
            font-size: 1rem;
            margin-top: 10px;
            display: block;
            width: 100%;
        }

        .hidden {
            visibility: hidden;
        }

        /* Install Banner - Sticky Bottom with Slide-Up Animation */
        .install-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            border-top: 6px solid #000;
            padding: 20px;
            background: #fff;
            box-shadow: 0 -4px 0 #000;
            transform: translateY(100%);
            transition: transform 0.3s ease-out;
        }

        .install-banner.show {
            transform: translateY(0);
            animation: bounce 0.6s ease-out;
        }

        @keyframes bounce {
            0% { transform: translateY(100%); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }

        .install-banner-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .install-banner-text {
            flex: 1;
        }

        .install-banner h3 {
            font-size: 1.3rem;
            font-weight: 900;
            margin-bottom: 8px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .install-banner p {
            font-size: 0.95rem;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .install-banner-buttons {
            display: flex;
            gap: 12px;
        }

        .install-btn, .dismiss-btn {
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            font-weight: 900;
            padding: 15px 30px;
            border: 5px solid #000;
            background: #000;
            color: #fff;
            cursor: pointer;
            text-transform: uppercase;
            transition: none;
            letter-spacing: 1px;
        }

        .install-btn:hover {
            background: #fff;
            color: #000;
        }

        .install-btn:active {
            transform: translate(2px, 2px);
        }

        .dismiss-btn {
            background: #fff;
            color: #000;
            border: 5px solid #000;
        }

        .dismiss-btn:hover {
            background: #000;
            color: #fff;
        }

        .dismiss-btn:active {
            transform: translate(2px, 2px);
        }

        @media (max-width: 768px) {
            .install-banner {
                padding: 15px;
                border-top: 5px solid #000;
            }

            .install-banner-content {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }

            .install-banner h3 {
                font-size: 1rem;
                margin-bottom: 5px;
                text-align: center;
            }

            .install-banner p {
                font-size: 0.8rem;
                text-align: center;
            }

            .install-banner-buttons {
                flex-direction: row;
                gap: 8px;
            }

            .install-btn, .dismiss-btn {
                font-size: 0.85rem;
                padding: 12px 20px;
                border: 4px solid #000;
                flex: 1;
            }
        }

        footer {
            border-top: 6px solid #000;
            margin-top: 50px;
            padding: 30px 20px;
            text-align: center;
        }

        footer p {
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        footer a {
            color: #000;
            text-decoration: none;
            border-bottom: 3px solid #000;
            font-weight: 900;
        }

        footer a:hover {
            background: #000;
            color: #fff;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
                padding: 12px;
                margin-bottom: 6px;
                letter-spacing: 2px;
            }

            .tagline {
                font-size: 0.7rem;
                padding: 8px;
                margin-bottom: 12px;
                letter-spacing: 0.5px;
            }

            .game-buttons {
                gap: 8px;
                margin: 12px 0;
            }

            button {
                font-size: 1rem;
                padding: 15px 20px;
                border: 4px solid #000;
            }

            .choice-display {
                margin: 12px 0;
                gap: 8px;
            }

            .choice-box {
                padding: 12px 8px;
                border: 4px solid #000;
            }

            .choice-box h2 {
                font-size: 0.75rem;
                margin-bottom: 6px;
            }

            .choice-icon {
                font-size: 2.5rem;
                margin: 8px 0;
            }

            .result {
                padding: 12px;
                margin: 12px 0;
                min-height: 70px;
                border: 5px solid #000;
            }

            .result h2 {
                font-size: 1.5rem;
                margin-bottom: 4px;
            }

            .result p {
                font-size: 0.9rem;
            }

            .scores {
                grid-template-columns: 1fr;
                margin-top: 50px;
            }

            .score-box {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>VERA'S ROCK PAPER SCISSORS BATTLE</h1>
        <div class="tagline">BECAUSE CHATGPT CAN'T PLAY FAIR — THIS COMPUTER ACTUALLY GOES FIRST</div>

        <!-- Install Banner -->
        <div class="install-banner" id="installBanner">
            <div class="install-banner-content">
                <div class="install-banner-text">
                    <h3>📱 INSTALL AS APP</h3>
                    <p>ADD TO HOME SCREEN FOR OFFLINE PLAY</p>
                </div>
                <div class="install-banner-buttons">
                    <button class="install-btn" id="installBtn">INSTALL</button>
                    <button class="dismiss-btn" id="dismissBtn">NOT NOW</button>
                </div>
            </div>
        </div>

        <div class="game-buttons">
            <button onclick="play('rock')">✊ ROCK</button>
            <button onclick="play('paper')">📄 PAPER</button>
            <button onclick="play('scissors')">✂️ SCISSORS</button>
        </div>

        <div class="choice-display">
            <div class="choice-box">
                <h2>YOU CHOSE</h2>
                <div class="choice-icon" id="playerChoice">❓</div>
                <p id="playerText">MAKE YOUR MOVE</p>
            </div>
            <div class="choice-box">
                <h2>COMPUTER CHOSE</h2>
                <div class="choice-icon" id="computerChoice">❓</div>
                <p id="computerText">WAITING...</p>
            </div>
        </div>

        <div class="result" id="result">
            <h2>READY TO BATTLE</h2>
            <p>CHOOSE YOUR WEAPON</p>
        </div>

        <div class="scores">
            <div class="score-box">
                <h3>SESSION SCORE</h3>
                <div class="score-line">
                    <span>WINS:</span>
                    <span id="sessionWins">0</span>
                </div>
                <div class="score-line">
                    <span>LOSSES:</span>
                    <span id="sessionLosses">0</span>
                </div>
                <div class="score-line">
                    <span>DRAWS:</span>
                    <span id="sessionDraws">0</span>
                </div>
            </div>
            <div class="score-box">
                <h3>ALL-TIME SCORE</h3>
                <div class="score-line">
                    <span>WINS:</span>
                    <span id="allTimeWins">0</span>
                </div>
                <div class="score-line">
                    <span>LOSSES:</span>
                    <span id="allTimeLosses">0</span>
                </div>
                <div class="score-line">
                    <span>DRAWS:</span>
                    <span id="allTimeDraws">0</span>
                </div>
                <button class="reset-btn" onclick="resetAllTime()">RESET ALL-TIME</button>
            </div>
        </div>
    </div>

    <script>
        // Game state
        const choices = ['rock', 'paper', 'scissors'];
        const icons = {
            rock: '✊',
            paper: '📄',
            scissors: '✂️'
        };
        const names = {
            rock: 'ROCK',
            paper: 'PAPER',
            scissors: 'SCISSORS'
        };

        // Session scores
        let sessionScore = {
            wins: 0,
            losses: 0,
            draws: 0
        };

        // Load all-time scores from localStorage
        function loadAllTimeScore() {
            const saved = localStorage.getItem('rpsAllTimeScore');
            if (saved) {
                return JSON.parse(saved);
            }
            return { wins: 0, losses: 0, draws: 0 };
        }

        // Save all-time scores to localStorage
        function saveAllTimeScore(score) {
            localStorage.setItem('rpsAllTimeScore', JSON.stringify(score));
        }

        let allTimeScore = loadAllTimeScore();

        // Update score displays
        function updateScores() {
            document.getElementById('sessionWins').textContent = sessionScore.wins;
            document.getElementById('sessionLosses').textContent = sessionScore.losses;
            document.getElementById('sessionDraws').textContent = sessionScore.draws;
            document.getElementById('allTimeWins').textContent = allTimeScore.wins;
            document.getElementById('allTimeLosses').textContent = allTimeScore.losses;
            document.getElementById('allTimeDraws').textContent = allTimeScore.draws;
        }

        // Determine winner
        function getWinner(player, computer) {
            if (player === computer) return 'draw';
            if (
                (player === 'rock' && computer === 'scissors') ||
                (player === 'paper' && computer === 'rock') ||
                (player === 'scissors' && computer === 'paper')
            ) {
                return 'win';
            }
            return 'lose';
        }

        // Get cheesy messages
        function getMessage(result) {
            const messages = {
                win: [
                    'YOU ATE AND LEFT NO CRUMBS!',
                    'SLAY QUEEN! NO CAP!',
                    'GIVING MAIN CHARACTER ENERGY',
                    "IT'S THE REBELLION FOR ME",
                    'PERIODT. YOU UNDERSTOOD THE ASSIGNMENT.',
                    "SHAKE IT OFF? NAH, YOU SHOOK 'EM OFF!",
                    'THIS IS WHY WE FIGHT',
                    "WHEN THE TRUTH HURTS...IT'S TRUE (YOU WON)",
                    'ONE ROUND OF APPLAUSE FOR YOU',
                    'LIVING RENT FREE IN THE COMPUTER\'S HEAD'
                ],
                lose: [
                    'NOT THE VIBE. TRY AGAIN BESTIE.',
                    'THIS IS YOUR VILLAIN ERA',
                    "YOU'RE IN YOUR FOLKLORE ERA (LOSING)",
                    'THE CALL IS COMING FROM INSIDE THE HOUSE',
                    'EVEN THE ROSES ARE WILTING',
                    'THAT\'S ROUGH BUDDY',
                    'THE REBELLION DOESN\'T ALWAYS WIN BATTLES',
                    'CLOSE YOUR EYES AND COUNT TO TEN',
                    'MAYBE THE COMPUTER DESERVES THE ROSE',
                    'FR FR, THAT WAS TOUGH'
                ],
                draw: [
                    'WE BOTH CHOSE CHAOS. RESPECT.',
                    "IT'S GIVING STALEMATE",
                    'NO ROSES FOR ANYONE TODAY',
                    'TWIN! WE MATCHED ENERGY',
                    'THE REBELLION AND EMPIRE: TIED',
                    'SAME WAVELENGTH, DIFFERENT OUTCOME',
                    'MID. JUST MID.',
                    'THIS LOVE LEFT US TIED',
                    'NEITHER OF US GOT THE ROSE',
                    'PERFECTLY BALANCED, AS ALL THINGS SHOULD BE'
                ]
            };
            const msgs = messages[result];
            return msgs[Math.floor(Math.random() * msgs.length)];
        }

        // Main game logic
        function play(playerChoice) {
            const computerChoice = choices[Math.floor(Math.random() * choices.length)];
            const result = getWinner(playerChoice, computerChoice);

            // Update displays
            document.getElementById('playerChoice').textContent = icons[playerChoice];
            document.getElementById('playerText').textContent = names[playerChoice];
            document.getElementById('computerChoice').textContent = icons[computerChoice];
            document.getElementById('computerText').textContent = names[computerChoice];

            // Update result
            const resultDiv = document.getElementById('result');
            const resultTitle = resultDiv.querySelector('h2');
            const resultText = resultDiv.querySelector('p');

            if (result === 'win') {
                resultTitle.textContent = 'YOU WIN!';
                sessionScore.wins++;
                allTimeScore.wins++;
            } else if (result === 'lose') {
                resultTitle.textContent = 'YOU LOSE!';
                sessionScore.losses++;
                allTimeScore.losses++;
            } else {
                resultTitle.textContent = 'DRAW!';
                sessionScore.draws++;
                allTimeScore.draws++;
            }

            resultText.textContent = getMessage(result);

            // Save and update scores
            saveAllTimeScore(allTimeScore);
            updateScores();
        }

        // Reset all-time scores
        function resetAllTime() {
            if (confirm('RESET ALL-TIME SCORES? THIS CANNOT BE UNDONE.')) {
                allTimeScore = { wins: 0, losses: 0, draws: 0 };
                saveAllTimeScore(allTimeScore);
                updateScores();
            }
        }

        // Initialize on load
        updateScores();

        // PWA Install Banner Logic
        let deferredPrompt;
        const installBanner = document.getElementById('installBanner');
        const installBtn = document.getElementById('installBtn');
        const dismissBtn = document.getElementById('dismissBtn');

        // Check if app is already installed or running in standalone mode
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches
                          || window.navigator.standalone
                          || document.referrer.includes('android-app://');

        // Session counting logic
        function incrementSessionCount() {
            let sessionCount = parseInt(localStorage.getItem('bannerSessionCount') || '0');
            sessionCount++;
            localStorage.setItem('bannerSessionCount', sessionCount.toString());
            return sessionCount;
        }

        function resetSessionCount() {
            localStorage.setItem('bannerSessionCount', '0');
        }

        // Check dismissal status
        const bannerDismissed = localStorage.getItem('installBannerDismissed') === 'true';
        const currentSessionCount = incrementSessionCount();

        // Reset dismissal after 10 sessions
        if (bannerDismissed && currentSessionCount >= 10) {
            localStorage.removeItem('installBannerDismissed');
            resetSessionCount();
        }

        // Should we show the banner?
        const shouldShowBanner = !isStandalone && (!bannerDismissed || currentSessionCount >= 10);

        // Capture the beforeinstallprompt event
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;

            // Show install banner if conditions are met
            if (shouldShowBanner) {
                setTimeout(() => {
                    installBanner.classList.add('show');
                }, 1000); // Slight delay for dramatic effect
            }
        });

        // Install button click handler
        installBtn.addEventListener('click', async () => {
            if (!deferredPrompt) {
                // Fallback for iOS and browsers that don't support beforeinstallprompt
                alert('To install:\n\niOS: Tap Share → Add to Home Screen\nAndroid: Tap Menu → Install app\nDesktop: Look for install icon in address bar');
                return;
            }

            // Show the install prompt
            deferredPrompt.prompt();

            // Wait for the user to respond to the prompt
            const { outcome } = await deferredPrompt.userChoice;

            console.log(`User response: ${outcome}`);

            // Hide the banner regardless of outcome
            installBanner.classList.remove('show');

            // If user accepted, mark as dismissed
            if (outcome === 'accepted') {
                localStorage.setItem('installBannerDismissed', 'true');
                resetSessionCount();
            }

            // Clear the deferredPrompt
            deferredPrompt = null;
        });

        // Dismiss button click handler
        dismissBtn.addEventListener('click', () => {
            installBanner.classList.remove('show');
            // Mark as dismissed and reset session count
            localStorage.setItem('installBannerDismissed', 'true');
            resetSessionCount();
        });

        // For iOS Safari and other browsers that don't support beforeinstallprompt
        // Show banner after a delay if conditions are met
        if (shouldShowBanner) {
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isSupported = isIOS || /Android/.test(navigator.userAgent) || /Chrome/.test(navigator.userAgent);

            if (isSupported && !deferredPrompt) {
                setTimeout(() => {
                    // Only show if beforeinstallprompt hasn't fired
                    if (!installBanner.classList.contains('show')) {
                        installBanner.classList.add('show');
                    }
                }, 2000); // Show after 2 seconds
            }
        }
    </script>

    <footer>
        <p>&copy; 2025 Neel Ketkar. ALL RIGHTS RESERVED.</p>
        <p>READ THE <a href="https://sparrowfm.github.io/sparrow/posts/building-veras-rock-paper-scissors-battle.html" target="_blank" rel="noopener">STORY BEHIND THIS GAME</a></p>
    </footer>

    <!-- Analytics -->
    <script data-goatcounter="https://sparrowfm.goatcounter.com/count"
            async src="//gc.zgo.at/count.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
